{% extends 'base.html.twig' %}

{% block title %}–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞{% endblock %}

{% block body %}
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1 class="h3">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞</h1>
                <span class="badge bg-primary fs-6">–í—Å–µ–≥–æ: {{ users|length }}</span>
            </div>

            <div class="card">
                <div class="card-header bg-white">
                    <h5 class="card-title mb-0">–°–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h5>
                </div>
                <div class="card-body">
                    {% if users is empty %}
                        <div class="text-center py-4">
                            <div class="text-muted">üò¥ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</div>
                        </div>
                    {% else %}
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-light">
                                <tr>
                                    <th>ID</th>
                                    <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                                    <th>Chat ID</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–°–æ–æ–±—â–µ–Ω–∏–π</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for user in users %}
                                    <tr>
                                        <td><strong>#{{ user.id }}</strong></td>
                                        <td>
                                            <div>
                                                <strong>{{ user.firstName }}</strong>
                                                {% if user.lastName %}
                                                    {{ user.lastName }}
                                                {% endif %}
                                            </div>
                                            {% if user.username %}
                                                <small class="text-muted">@{{ user.username }}</small>
                                            {% endif %}
                                            <div>
                                                <small class="text-muted">
                                                    {{ user.age }} –ª–µ—Ç,
                                                    {% if user.gender == 'male' %}‚ôÇÔ∏è –º—É–∂.
                                                    {% elseif user.gender == 'female' %}‚ôÄÔ∏è –∂–µ–Ω.
                                                    {% else %}‚ùì –¥—Ä—É–≥.
                                                    {% endif %}
                                                </small>
                                            </div>
                                        </td>
                                        <td><code class="text-primary">{{ user.chatId }}</code></td>
                                        <td>
                                        <span class="badge bg-{{ user.state == 'completed' ? 'success' : 'warning' }}">
                                            {{ user.state }}
                                        </span>
                                        </td>
                                        <td>
                                            <span class="badge bg-info">{{ user.messages|length }}</span>
                                        </td>
                                        <td>
                                            <div class="btn-group btn-group-sm">
                                                <button class="btn btn-outline-primary">üëÅÔ∏è</button>
                                                <button class="btn btn-outline-secondary">‚úâÔ∏è</button>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}
